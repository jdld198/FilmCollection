{% extends 'base.html' %}

{% block body %}
<div class="container color-white">
    <div class="title">
        <p> {{ shelf.shelf_name }} </p>
    </div>
    {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
    <table class="table body-font color-white">
        <thead>
            <th>Title</th>
            <th>Genre</th>
            <th>Year</th>
        </thead>
        <tbody>
            {% for movie in shelf.movie_set.all %}
            <tr>
                <td for="movie{{ forloop.counter }}">{{ movie.movie_name }}</td>
                <td for="movie{{ forloop.counter }}">{{ movie.movie_genre }}</td>
                <td for="movie{{ forloop.counter }}">{{ movie.release_year }}</td>
            </tr>
            <tr class="summary">
                <td colspan=3>
                    <div class = "hiddenSummary" for="movie{{ forloop.counter}}"> 
                        &emsp;&emsp; {{ movie.movie_summary }}
                        <a href="{% url 'collection:update' shelf.id movie.id %}"> Edit </a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <form action="{% url 'collection:add_film' shelf.id %}" method="post">
        {% csrf_token %}
        <input type="text" name="title" placeholder="Title">
        <input type="text" name="genre" placeholder="Genre">
        <input type="number" maxlength="4" name="year" placeholder="Year">
        <input type="text" name="summary" placeholder="Enter a summary">
        <button type="submit"> Add Film </button>
    </form>

    <a href="{% url 'collection:index' %}">Back to Index</a>
</div>

<script>
    $(document).ready(function () {
        $('.table tr').click(function () {
            var s = $(this).next('.summary');
            s = s.children().children('.hiddenSummary');
            s.slideToggle();
        });
    });
</script>
{% endblock %}